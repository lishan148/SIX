on:
  poll:
    url: https://macaumarksix.com/api/live2
    deduplicationKey: expect
jobs:
  print:
    name: Print
    runs-on: ubuntu-latest     
    steps:     
      - name: Send Bark Message
        run: |        
          key1="${{ on.poll.outputs.openCode }}"
          key2="${{ on.poll.outputs.zodiac }}"
          key3="${{ on.poll.outputs.openTime }}"
          key4="${{ on.poll.outputs.wave }}"
          chinese_text="${key1}%0D%0A${key2}%0D%0A${key3}%0D%0A${key4}"
          # 使用 bash 进行 URL 编码
           encoded_text=$(echo -n "$chinese_text" | jq -sRr @uri)        
          # 定义目标 URL 列表
          urls=("https://api.day.app/H9nYt9PJbr6LcBXYaiWPTU")
          # 循环发送请求到每个 URL
          for url in "${urls[@]}"
          do
            echo "Sending data to $url/$encoded_text"
            curl -s "$url/$encoded_text"
          done
